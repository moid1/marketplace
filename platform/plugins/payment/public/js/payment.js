(()=>{"use strict";var e=e||{},t="https://api-sandbox.nowpayments.io/v1/",n={url:"https://api-sandbox.nowpayments.io/v1/",method:"GET",timeout:0,headers:{"x-api-key":"YGC0MQP-PR54JP2-HEZRDDX-RZWESF5"}},a=function(){$(".payment-info-loading").show(),$(".payment-checkout-btn").prop("disabled",!0)};function o(e){a(),n.url=t+"estimate",n.data={currency_to:e,amount:$("input[name=amount]").val(),currency_from:$("input[name=currency]").val()},$.ajax(n).done((function(e){$(".estimated-amount .estimated-amount-description").text("Crypto Total "+parseFloat(e.estimated_amount)+" "+e.currency_to.toUpperCase()),$(".crypto-payment-row").removeClass("d-none"),$("#total-crypto-text").text(parseFloat(e.estimated_amount)+" "+e.currency_to.toUpperCase()),$("input[name=crypto_payment]").val(e.estimated_amount+" "+e.currency_to.toUpperCase()),$(".payment-info-loading").hide(),$(".payment-checkout-btn").prop("disabled",!1)}))}e.initResources=function(){var e=$(document).find("input[name=payment_method]").first();e.length&&(e.trigger("click").trigger("change"),e.closest(".list-group-item").find(".payment_collapse_wrap").addClass("show")),$(".stripe-card-wrapper").length>0&&new Card({form:".payment-checkout-form",container:".stripe-card-wrapper",formSelectors:{numberInput:"input#stripe-number",expiryInput:"input#stripe-exp",cvcInput:"input#stripe-cvc",nameInput:"input#stripe-name"},width:350,formatting:!0,messages:{validDate:"valid\ndate",monthYear:"mm/yyyy"},placeholders:{number:"•••• •••• •••• ••••",name:"Full Name",expiry:"••/••",cvc:"•••"},masks:{cardNumber:"•"},debug:!1})},e.init=function(){e.initResources(),$(document).on("change",".js_payment_method",(function(){$(".payment_collapse_wrap").removeClass("collapse").removeClass("show").removeClass("active"),"crypto"===$("input[name=payment_method]:checked").val()?($(".payment-checkout-btn").text("Proceed To Crypto Checkout"),a(),n.url=t+"merchant/coins",document.getElementById("crypto_currency").options.length=0,$.ajax(n).done((function(e){var t=[];$(e.selectedCurrencies).each((function(e,n){"BTC"!=n&&"ETH"!=n||t.push(new Option(n.toUpperCase(),n))})),$("#crypto_currency").append(t),$(".cryptoCurrencySelector").removeClass("d-none"),o("ETH")}))):$(".payment-checkout-btn").text("Checkout")})),$(document).off("click",".payment-checkout-btn").on("click",".payment-checkout-btn",(function(e){e.preventDefault();var t=$(this),n=t.closest("form");t.attr("disabled","disabled");var a=t.html();t.html('<i class="fa fa-gear fa-spin"></i> '+t.data("processing-text")),"stripe"===$("input[name=payment_method]:checked").val()?(Stripe.setPublishableKey($("#payment-stripe-key").data("value")),Stripe.card.createToken(n,(function(e,o){o.error?("undefined"!=typeof Botble?Botble.showError(o.error.message,t.data("error-header")):alert(o.error.message),t.removeAttr("disabled"),t.html(a)):(n.append($('<input type="hidden" name="stripeToken">').val(o.id)),n.submit())}))):n.submit()}))},$(document).ready((function(){e.init(),document.addEventListener("payment-form-reloaded",(function(){e.initResources()})),$(document).on("change","#crypto_currency",(function(){o($(this).find(":selected").text())}))}))})();
